# 文档生命周期管理

> **版本**: 1.0.0
> **创建日期**: 2026-02-04
> **适用范围**: Claude CLI Provider 项目

本文档说明项目文档的生命周期管理流程和状态管理规范。

---

## 🔄 生命周期概览

```
┌─────────────────────────────────────────────────────────────┐
│                    文档生命周期                              │
└─────────────────────────────────────────────────────────────┘

   设计阶段          实施阶段          完成归档
      ↓                 ↓                 ↓
  ┌────────┐      ┌────────┐      ┌────────┐
  │ design │  →   │对应目录 │  →   │ archive│
  │ ❌待实施│      │ ✅已实施│      │ 历史记录│
  └────────┘      └────────┘      └────────┘
```

---

## 📋 阶段详解

### 1. 设计阶段 (design/)

**特征**：
- 文档位于 `design/` 目录
- 状态标记为 ❌ 待实施
- README.md 状态表中显示为待实施状态

**包含内容**：
- 功能设计文档
- 技术方案设计
- API 设计
- 数据结构设计

**示例文档**：
```
design/
├── workflow-scaffolding-design.md    # ✅ 已实施
├── streaming-output-design.md        # ✅ 已实施
└── multi-session-design.md           # ❌ 待实施
```

**文档内元数据**：
```markdown
> **版本**: 1.0.0
> **创建日期**: 2026-02-04
> **状态**: 设计阶段，待实施
> **适用对象**: 开发者
```

---

### 2. 实施阶段 (对应目录)

**特征**：
- 功能已实现
- 状态标记为 ✅ 已实施
- 文档可能转移到其他目录或保留在 `design/`

**转移策略**：

| 文档类型 | 实施后位置 | 说明 |
|---------|-----------|------|
| 功能设计 | `design/` 或 `architecture/` | 保留在 design/ 或转移到架构文档 |
| 使用指南 | `guides/` | 面向用户的操作文档 |
| 技术参考 | `references/` | 技术实现参考 |
| 开发总结 | `development/` | 开发过程总结 |

**README.md 状态表更新**：
```markdown
| 文档 | 状态 | 实施时间 | 描述 |
|------|------|----------|------|
| multi-session-design.md | ✅ 已实施 | 2026-02-04 | 多会话管理功能 |
```

**文档内元数据更新**：
```markdown
> **版本**: 1.0.0
> **创建日期**: 2026-02-04
> **实施日期**: 2026-02-05
> **状态**: 已实施
> **实现文件**: `server.js:123-250`
> **适用对象**: 开发者
```

---

### 3. 完成归档 (archive/)

**特征**：
- 文档已过时或不再活跃
- 转移到 `archive/` 对应子目录
- 从主要导航中移除

**归档类型**：

#### archive/phases/ - 阶段性归档
适用于项目阶段性完成后的文档归档。

```
archive/phases/
├── phase-1/                       # 第一阶段（基础功能）
│   ├── workflow-scaffolding.md
│   └── streaming-output.md
└── phase-2/                       # 第二阶段（高级功能）
    └── multi-session.md
```

#### archive/sessions/ - 会话归档
适用于临时会话记录和分析报告。

```
archive/sessions/
├── 2026-02-03-session-1/          # 按日期归档
│   ├── analysis-report.md
│   └── temp-notes.md
└── 2026-02-04-session-2/
    └── summary.md
```

#### archive/reports/ - 历史报告归档
适用于过时的项目报告。

```
archive/reports/
├── analysis-report-2026-02-03.md
└── weekly-summary-2026-02-03.md
```

---

## 📊 状态管理规范

### 状态符号

| 符号 | 含义 | 使用场景 |
|------|------|----------|
| ✅ | 已实施 | 功能已实现并测试 |
| ❌ | 待实施 | 设计阶段，功能未实现 |
| 🔄 | 进行中 | 正在实施（可选） |

### 双重标记机制

#### 1. README.md 状态表

```markdown
## 📚 设计文档

| 文档 | 状态 | 实施时间 | 描述 |
|------|------|----------|------|
| workflow-scaffolding-design.md | ✅ 已实施 | 2026-02-03 | 工作流脚手架 |
| streaming-output-design.md | ✅ 已实施 | 2026-02-03 | 流式输出 |
| multi-session-design.md | ❌ 待实施 | - | 多会话管理 |
```

#### 2. 文档内元数据

**待实施状态**：
```markdown
> **版本**: 1.0.0
> **创建日期**: 2026-02-04
> **状态**: 设计阶段，待实施
> **优先级**: 中
> **预计实施**: 2026-02-10
```

**已实施状态**：
```markdown
> **版本**: 1.0.0
> **创建日期**: 2026-02-04
> **实施日期**: 2026-02-05
> **状态**: 已实施
> **实现文件**: `server.js:123-250`, `api/stream.js`
> **测试状态**: 已通过
```

---

## 🔄 转移决策树

```
功能设计文档实施后如何处理？

┌─ 是否仍需频繁参考？
│  ├─ 是 → 保留在 design/，更新状态为 ✅
│  └─ 否 → 继续判断
│
├─ 是否属于用户指南？
│  ├─ 是 → 转移到 guides/
│  └─ 否 → 继续判断
│
├─ 是否属于架构文档？
│  ├─ 是 → 转移到 architecture/
│  └─ 否 → 继续判断
│
├─ 是否是开发总结？
│  ├─ 是 → 创建在 development/
│  └─ 否 → 保留在 design/，更新状态
```

---

## 📝 转移操作步骤

### 从 design/ 转移到其他目录

1. **更新状态表**
   ```markdown
   | 文档 | 状态 | 实施时间 | 描述 |
   |------|------|----------|------|
   | api-authentication.md | ✅ 已实施 | 2026-02-05 | API 认证功能 |
   ```

2. **更新文档内元数据**
   ```markdown
   > **版本**: 1.0.0
   > **创建日期**: 2026-02-04
   > **实施日期**: 2026-02-05
   > **状态**: 已实施
   > **实现文件**: `server.js:45-120`
   ```

3. **转移文档**（如需要）
   ```bash
   # 转移到 guides/
   mv design/api-authentication.md guides/api-auth-guide.md
   ```

4. **更新导航**
   - 修改主 README.md
   - 修改对应目录的 README.md
   - 更新文档间的交叉引用

### 归档到 archive/

1. **选择归档类型**
   ```bash
   # 阶段性归档
   mkdir -p archive/phases/phase-1
   mv design/feature.md archive/phases/phase-1/

   # 会话归档
   mkdir -p archive/sessions/2026-02-03-session-1
   mv temp-analysis.md archive/sessions/2026-02-03-session-1/
   ```

2. **创建归档说明**
   ```markdown
   # Phase 1 归档

   > **归档日期**: 2026-02-05
   > **归档原因**: 第一阶段功能已完成
   > **包含内容**: 基础功能设计文档
   ```

3. **从主文档中移除引用**
   - 从状态表中删除
   - 从导航中移除
   - 更新交叉引用

---

## ⚠️ 注意事项

### 状态同步
- ✅ **务必保持**：README.md 状态表与文档内元数据必须一致
- ❌ **避免不一致**：状态表显示已实施但文档内显示待实施

### 转移时机
- ✅ **及时转移**：功能实施完成后及时更新状态
- ❌ **避免延迟**：不要长期保留过时状态

### 归档原则
- ✅ **保留价值**：归档不是删除，保留历史记录
- ❌ **避免丢失**：不要直接删除可能有用的文档

### 引用更新
- ✅ **更新所有引用**：文档移动后更新所有交叉引用
- ❌ **避免断链**：不要留下无效的文档链接

---

## 📋 生命周期检查清单

### 设计阶段
- [ ] 文档已创建在 `design/` 目录
- [ ] 状态表已添加 ❌ 待实施标记
- [ ] 文档内元数据已添加
- [ ] 设计方案已评审

### 实施阶段
- [ ] 功能已实现
- [ ] 状态表已更新为 ✅ 已实施
- [ ] 已添加实施时间
- [ ] 文档内元数据已更新
- [ ] 已添加实现文件信息
- [ ] （如需要）文档已转移到对应目录
- [ ] 所有交叉引用已更新

### 完成归档
- [ ] 已确定归档类型（phases/sessions/reports）
- [ ] 文档已转移到 `archive/` 对应子目录
- [ ] 已创建归档说明
- [ ] 已从主文档中移除引用
- [ ] 状态表已删除对应条目

---

## 🔗 相关文档

- [分类定义](CATEGORIES.md)
- [文档模板](TEMPLATES.md)
- [主 README](../README.md)

---

## 📌 最佳实践

### 1. 定期检查
每两周检查一次 `design/` 目录中的文档状态，确保状态标记准确。

### 2. 版本控制
使用 Git 追踪文档变更，保留历史版本。

### 3. 自动化
考虑使用脚本自动检查状态一致性。

### 4. 文档评审
重要文档的转移和归档应经过评审。

### 5. 用户反馈
定期收集用户对文档组织的反馈，持续优化。

---

**最后更新**: 2026-02-04
**维护者**: 项目团队
**反馈**: 如有问题请在项目中提出 Issue
