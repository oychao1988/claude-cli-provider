# æ··åˆæ¨¡å¼å®ç° - ç»¼åˆæµ‹è¯•è®¡åˆ’

> **ç‰ˆæœ¬**: 1.0.0
> **åˆ›å»ºæ—¥æœŸ**: 2026-02-05
> **çŠ¶æ€**: âœ… å·²å®Œæˆ
> **é€‚ç”¨å¯¹è±¡**: é¡¹ç›®ç®¡ç†è€…ã€æµ‹è¯•äººå‘˜ã€å¼€å‘è€…
> **æœ€åæ›´æ–°**: 2026-02-05

---

## ğŸ“‹ æ–‡æ¡£æ¦‚è¿°

æœ¬æ–‡æ¡£å®šä¹‰äº† Claude CLI Provider æ··åˆæ¨¡å¼å®ç°çš„ç»¼åˆæµ‹è¯•è®¡åˆ’ï¼ŒåŒ…æ‹¬å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€æ€§èƒ½æµ‹è¯•å’ŒéªŒæ”¶æµ‹è¯•ã€‚

---

## ğŸ¯ æµ‹è¯•ç›®æ ‡

### ä¸»è¦ç›®æ ‡

1. âœ… **åŠŸèƒ½å®Œæ•´æ€§** - éªŒè¯æ‰€æœ‰åŠŸèƒ½æŒ‰è®¾è®¡å·¥ä½œ
2. âœ… **è´¨é‡ä¿è¯** - ç¡®ä¿ä»£ç è´¨é‡å’Œç¨³å®šæ€§
3. âœ… **æ€§èƒ½éªŒè¯** - ç¡®è®¤æ€§èƒ½æŒ‡æ ‡è¾¾æ ‡
4. âœ… **å®‰å…¨åˆè§„** - éªŒè¯å®‰å…¨æ§åˆ¶æœ‰æ•ˆ
5. âœ… **ç”Ÿäº§å°±ç»ª** - ç¡®ä¿ç³»ç»Ÿå¯ä»¥å®‰å…¨éƒ¨ç½²

### æµ‹è¯•èŒƒå›´

**åŒ…å«**:
- âœ… OpenAI å…¼å®¹æ¨¡å¼çš„æ‰€æœ‰åŠŸèƒ½
- âœ… Agent æ¨¡å¼çš„æ‰€æœ‰åŠŸèƒ½
- âœ… æ ¸å¿ƒç»„ä»¶çš„é€»è¾‘æ­£ç¡®æ€§
- âœ… API ç«¯ç‚¹çš„åŠŸèƒ½éªŒè¯
- âœ… æ€§èƒ½æŒ‡æ ‡è¾¾æ ‡
- âœ… é”™è¯¯å¤„ç†å’Œè¾¹ç•Œæƒ…å†µ
- âœ… å®‰å…¨æ§åˆ¶æœ‰æ•ˆæ€§

**ä¸åŒ…å«**:
- âŒ Claude CLI æœ¬èº«çš„æµ‹è¯•
- âŒ ç¬¬ä¸‰æ–¹åº“çš„æµ‹è¯•
- âŒ å‹åŠ›æµ‹è¯•ï¼ˆè¶…å‡ºæ€§èƒ½æµ‹è¯•èŒƒå›´ï¼‰
- âŒ å®‰å…¨æ¸—é€æµ‹è¯•

---

## ğŸ“Š å½“å‰æµ‹è¯•çŠ¶æ€

### å·²å®Œæˆçš„æµ‹è¯•

| æµ‹è¯•ç±»å‹ | æ•°é‡ | é€šè¿‡ç‡ | çŠ¶æ€ |
|---------|------|--------|------|
| **å•å…ƒæµ‹è¯•** | 170 | 100% | âœ… å®Œæˆ |
| **é›†æˆæµ‹è¯•åœºæ™¯** | 17 | - | ğŸ“ å·²åˆ›å»º |
| **æ€§èƒ½æµ‹è¯•å¥—ä»¶** | 3 | - | ğŸ“ å·²åˆ›å»º |

### æµ‹è¯•è¦†ç›–ç‡

| æ¨¡å— | è¯­å¥è¦†ç›– | åˆ†æ”¯è¦†ç›– | çŠ¶æ€ |
|------|---------|---------|------|
| æ ¸å¿ƒé€»è¾‘ | 95%+ | 88%+ | âœ… ä¼˜ç§€ |
| é€‚é…å™¨å±‚ | 0% | 0% | âš ï¸ å¾…é›†æˆæµ‹è¯• |
| è·¯ç”±å±‚ | 0% | 0% | âš ï¸ å¾…é›†æˆæµ‹è¯• |
| **æ€»ä½“** | **45.12%** | **49.17%** | âš ï¸ éœ€é›†æˆæµ‹è¯• |

---

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### æµ‹è¯•é‡‘å­—å¡”

```
        /\
       /  \
      / E2E \        3 ä¸ªæ€§èƒ½æµ‹è¯•
     /  5%   \
    /----------\
   /  é›†æˆæµ‹è¯•   \    17 ä¸ªåœºæ™¯
  /     25%      \
 /----------------\
/   å•å…ƒæµ‹è¯•        \  170 ä¸ªæµ‹è¯•
/      70%          \
/--------------------\
```

**æ¯”ä¾‹åˆ†é…**:
- **å•å…ƒæµ‹è¯• (70%)**: æµ‹è¯•ç‹¬ç«‹ç»„ä»¶å’Œå‡½æ•°
- **é›†æˆæµ‹è¯• (25%)**: æµ‹è¯•ç»„ä»¶é—´äº¤äº’
- **æ€§èƒ½æµ‹è¯• (5%)**: éªŒè¯æ€§èƒ½æŒ‡æ ‡

### æµ‹è¯•ç±»å‹

#### 1. å•å…ƒæµ‹è¯• âœ…

**ç›®æ ‡**: éªŒè¯æ¯ä¸ªå‡½æ•°å’Œç±»çš„ç‹¬ç«‹è¡Œä¸º

**å·²è¦†ç›–**:
- âœ… MessageFormatter - 28 ä¸ªæµ‹è¯•
- âœ… ResponseTransformer - 38 ä¸ªæµ‹è¯•
- âœ… SessionManager - 40 ä¸ªæµ‹è¯•
- âœ… ScreenParser - 65 ä¸ªæµ‹è¯•
- âœ… Logger - 12 ä¸ªæµ‹è¯•
- âœ… Errors - 14 ä¸ªæµ‹è¯•
- âœ… ProcessManager - 10 ä¸ªæµ‹è¯•

**é€šè¿‡ç‡**: 100% (170/170)

#### 2. é›†æˆæµ‹è¯• ğŸ“

**ç›®æ ‡**: éªŒè¯ç»„ä»¶é—´çš„äº¤äº’å’Œç«¯åˆ°ç«¯åŠŸèƒ½

**å·²åˆ›å»º**:
- ğŸ“ OpenAI æ¨¡å¼é›†æˆæµ‹è¯• - 8 ä¸ªåœºæ™¯
- ğŸ“ Agent æ¨¡å¼é›†æˆæµ‹è¯• - 9 ä¸ªåœºæ™¯

**çŠ¶æ€**: ä»£ç å·²ç¼–å†™ï¼Œå¾…æ‰§è¡Œ

#### 3. æ€§èƒ½æµ‹è¯• ğŸ“

**ç›®æ ‡**: éªŒè¯ç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡

**å·²åˆ›å»º**:
- ğŸ“ å“åº”æ—¶é—´æµ‹è¯• - 5 ä¸ªæŒ‡æ ‡
- ğŸ“ å¹¶å‘æµ‹è¯• - 3 ä¸ªåœºæ™¯
- ğŸ“ å†…å­˜æµ‹è¯• - 3 ä¸ªåœºæ™¯

**çŠ¶æ€**: ä»£ç å·²ç¼–å†™ï¼Œå¾…æ‰§è¡Œ

---

## ğŸ”¬ è¯¦ç»†æµ‹è¯•è®¡åˆ’

### é˜¶æ®µ 1: ç¯å¢ƒå‡†å¤‡ (é¢„è®¡ 30 åˆ†é’Ÿ)

#### 1.1 æµ‹è¯•ç¯å¢ƒæ­å»º

**å‰ç½®æ¡ä»¶**:
- [ ] Node.js v18+ å·²å®‰è£…
- [ ] Claude CLI å·²å®‰è£…å¹¶å¯ç”¨
- [ ] API Key å·²é…ç½®ï¼ˆå¯é€‰ï¼‰
- [ ] ç«¯å£ 3912 å¯ç”¨

**æ£€æŸ¥æ¸…å•**:
```bash
# 1. æ£€æŸ¥ Node.js ç‰ˆæœ¬
node --version  # åº”è¯¥ >= v18

# 2. æ£€æŸ¥ Claude CLI
claude --version

# 3. æ£€æŸ¥ç«¯å£å ç”¨
lsof -i :3912  # åº”è¯¥ä¸ºç©ºæˆ–å¯ç»ˆæ­¢

# 4. å®‰è£…ä¾èµ–
npm install

# 5. è¿è¡Œå•å…ƒæµ‹è¯•éªŒè¯
npm test
```

#### 1.2 é…ç½®éªŒè¯

**ç¯å¢ƒå˜é‡**:
```bash
# å¯é€‰é…ç½®
export API_KEY="test-key"           # API è®¤è¯
export LOG_LEVEL="info"             # æ—¥å¿—çº§åˆ«
export NODE_ENV="development"       # ç¯å¢ƒ
export CLAUDE_BIN="claude"          # Claude CLI è·¯å¾„
export MAX_PROCESSES="5"            # è¿›ç¨‹æ± å¤§å°
export MAX_SESSIONS="10"            # æœ€å¤§ä¼šè¯æ•°
```

**éªŒè¯æ­¥éª¤**:
- [ ] ç¯å¢ƒå˜é‡å·²è®¾ç½®
- [ ] é…ç½®æ–‡ä»¶æ­£ç¡®åŠ è½½
- [ ] æ—¥å¿—è¾“å‡ºæ­£å¸¸

---

### é˜¶æ®µ 2: å•å…ƒæµ‹è¯•éªŒè¯ (é¢„è®¡ 15 åˆ†é’Ÿ)

#### 2.1 è¿è¡Œå•å…ƒæµ‹è¯•

**å‘½ä»¤**:
```bash
npm test
```

**é¢„æœŸç»“æœ**:
```
Test Suites: 7 passed, 7 total
Tests:       170 passed, 170 total
Time:        < 5s
```

**éªŒè¯æ ‡å‡†**:
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼ˆ170/170ï¼‰
- [ ] æ— é”™è¯¯æˆ–è­¦å‘Š
- [ ] æ‰§è¡Œæ—¶é—´ < 5 ç§’

#### 2.2 è¦†ç›–ç‡æ£€æŸ¥

**å‘½ä»¤**:
```bash
npm test -- --coverage --coverageReporters=text
```

**é¢„æœŸè¦†ç›–ç‡**:
- [ ] æ ¸å¿ƒç»„ä»¶ > 95%
- [ ] MessageFormatter = 100%
- [ ] SessionManager > 95%
- [ ] ScreenParser > 90%

---

### é˜¶æ®µ 3: é›†æˆæµ‹è¯•æ‰§è¡Œ (é¢„è®¡ 1-2 å°æ—¶)

#### 3.1 å¯åŠ¨æµ‹è¯•æœåŠ¡å™¨

**ç»ˆç«¯ 1**:
```bash
# å¯åŠ¨æœåŠ¡å™¨
npm start

# é¢„æœŸè¾“å‡º:
# Server running on http://0.0.0.0:3912
# Environment: development
```

**éªŒè¯**:
- [ ] æœåŠ¡å™¨æˆåŠŸå¯åŠ¨
- [ ] ç›‘å¬ç«¯å£ 3912
- [ ] æ— é”™è¯¯æ—¥å¿—

#### 3.2 OpenAI æ¨¡å¼é›†æˆæµ‹è¯•

**æµ‹è¯•æ–‡ä»¶**: `tests/integration/openai-mode.test.js`

**åœºæ™¯æ¸…å•**:

##### åœºæ™¯ 1: å¥åº·æ£€æŸ¥
```bash
curl http://localhost:3912/health
```
**é¢„æœŸ**:
```json
{
  "status": "ok",
  "timestamp": "2026-02-05T...",
  "uptime": ...,
  "version": "2.0.0"
}
```
**éªŒè¯**:
- [ ] çŠ¶æ€ç  200
- [ ] å“åº”æ ¼å¼æ­£ç¡®
- [ ] uptime > 0

---

##### åœºæ™¯ 2: åŸºç¡€èŠå¤©è¯·æ±‚ï¼ˆéæµå¼ï¼‰
```bash
curl -X POST http://localhost:3912/v1/chat/completions \
  -H "Content-Type: application/json" \
  -d '{
    "model": "sonnet",
    "messages": [
      {"role": "user", "content": "Say \\"Hello World\\""}
    ],
    "stream": false
  }'
```
**é¢„æœŸ**:
```json
{
  "id": "chatcmpl-...",
  "object": "chat.completion",
  "created": ...,
  "model": "claude-sonnet",
  "choices": [{
    "index": 0,
    "message": {
      "role": "assistant",
      "content": "Hello World"
    },
    "finish_reason": "stop"
  }],
  "usage": {...}
}
```
**éªŒè¯**:
- [ ] çŠ¶æ€ç  200
- [ ] å“åº”æ ¼å¼ç¬¦åˆ OpenAI è§„èŒƒ
- [ ] content åŒ…å« "Hello"
- [ ] finish_reason = "stop"

---

##### åœºæ™¯ 3: æµå¼èŠå¤©è¯·æ±‚
```bash
curl -X POST http://localhost:3912/v1/chat/completions \
  -H "Content-Type: application/json" \
  -d '{
    "model": "sonnet",
    "messages": [
      {"role": "user", "content": "Count to 5"}
    ],
    "stream": true
  }'
```
**é¢„æœŸ**:
```
data: {"id":"chatcmpl-...","choices":[...],"object":"chat.completion.chunk"}

data: {"id":"chatcmpl-...","choices":[...],"object":"chat.completion.chunk"}

...

data: [DONE]
```
**éªŒè¯**:
- [ ] çŠ¶æ€ç  200
- [ ] Content-Type: text/event-stream
- [ ] å¤šä¸ª data å—
- [ ] æœ€åä¸€ä¸ªæ˜¯ `[DONE]`
- [ ] å†…å®¹è¿è´¯

---

##### åœºæ™¯ 4: ç³»ç»Ÿæç¤ºè¯
```bash
curl -X POST http://localhost:3912/v1/chat/completions \
  -H "Content-Type: application/json" \
  -d '{
    "model": "sonnet",
    "messages": [
      {"role": "system", "content": "You are a pirate. Always speak like a pirate."},
      {"role": "user", "content": "Hello"}
    ],
    "stream": false
  }'
```
**éªŒè¯**:
- [ ] å“åº”åŒ…å«æµ·ç›—ç”¨è¯­ï¼ˆå¦‚ "Ahoy", "Matey"ï¼‰
- [ ] ç³»ç»Ÿæç¤ºè¯ç”Ÿæ•ˆ

---

##### åœºæ™¯ 5: å¤šè½®å¯¹è¯
```bash
curl -X POST http://localhost:3912/v1/chat/completions \
  -H "Content-Type: application/json" \
  -d '{
    "model": "sonnet",
    "messages": [
      {"role": "user", "content": "My name is Alice"},
      {"role": "assistant", "content": "Hello Alice!"},
      {"role": "user", "content": "What is my name?"}
    ],
    "stream": false
  }'
```
**éªŒè¯**:
- [ ] å“åº”åŒ…å« "Alice"
- [ ] ä¸Šä¸‹æ–‡æ­£ç¡®ä¼ é€’

---

##### åœºæ™¯ 6: API Key è®¤è¯
```bash
# è®¾ç½® API Key
export API_KEY="secret-key"

# å¯åŠ¨æœåŠ¡å™¨
npm start

# æ—  Key è¯·æ±‚
curl http://localhost:3912/health
# é¢„æœŸ: 200

# éœ€è¦ Key çš„è¯·æ±‚
curl -X POST http://localhost:3912/v1/chat/completions \
  -H "Content-Type: application/json" \
  -d '{"model":"sonnet","messages":[{"role":"user","content":"Hi"}]}'
# é¢„æœŸ: 401

# æ­£ç¡®çš„ Key
curl -X POST http://localhost:3912/v1/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer secret-key" \
  -d '{"model":"sonnet","messages":[{"role":"user","content":"Hi"}]}'
# é¢„æœŸ: 200
```
**éªŒè¯**:
- [ ] æ—  Key æ—¶è¢«æ‹’ç»ï¼ˆ401ï¼‰
- [ ] æ­£ç¡® Key æ—¶é€šè¿‡ï¼ˆ200ï¼‰
- [ ] å¥åº·æ£€æŸ¥ä¸å—å½±å“

---

##### åœºæ™¯ 7: é”™è¯¯å¤„ç† - 404
```bash
curl http://localhost:3912/v1/invalid-endpoint
```
**éªŒè¯**:
- [ ] çŠ¶æ€ç  404
- [ ] é”™è¯¯æ¶ˆæ¯æ¸…æ™°

---

##### åœºæ™¯ 8: é”™è¯¯å¤„ç† - æ— æ•ˆå‚æ•°
```bash
curl -X POST http://localhost:3912/v1/chat/completions \
  -H "Content-Type: application/json" \
  -d '{
    "model": "sonnet",
    "messages": []
  }'
```
**éªŒè¯**:
- [ ] çŠ¶æ€ç  400
- [ ] é”™è¯¯æ¶ˆæ¯è¯´æ˜åŸå› 

---

#### 3.3 Agent æ¨¡å¼é›†æˆæµ‹è¯•

**æµ‹è¯•æ–‡ä»¶**: `tests/integration/agent-mode.test.js`

**åœºæ™¯æ¸…å•**:

##### åœºæ™¯ 1: åˆ›å»ºä¼šè¯å¹¶å‘é€æ¶ˆæ¯
```bash
curl -X POST http://localhost:3912/v1/agent/chat \
  -H "Content-Type: application/json" \
  -d '{
    "content": "What is 2+2?",
    "options": {
      "model": "sonnet",
      "allowedTools": []
    }
  }'
```
**é¢„æœŸ**:
```
event: session
data: {"session_id":"uuid-...","status":"running"}

event: content
data: {"content":"2+2 equals 4"}

event: done
data: {}
```
**éªŒè¯**:
- [ ] çŠ¶æ€ç  200
- [ ] Content-Type: text/event-stream
- [ ] session_id æ˜¯æœ‰æ•ˆ UUID
- [ ] å†…å®¹æ­£ç¡®
- [ ] äº‹ä»¶æµå®Œæ•´

---

##### åœºæ™¯ 2: ä¼šè¯åˆ—è¡¨
```bash
# 1. åˆ›å»ºä¼šè¯
curl -X POST http://localhost:3912/v1/agent/chat \
  -H "Content-Type: application/json" \
  -d '{"content":"Hi"}'

# 2. åˆ—å‡ºä¼šè¯
curl http://localhost:3912/v1/agent/sessions
```
**é¢„æœŸ**:
```json
{
  "sessions": [
    {
      "session_id": "uuid-...",
      "created_at": "2026-02-05T...",
      "last_activity": "2026-02-05T...",
      "message_count": 2,
      "status": "stable",
      "has_pty_process": true
    }
  ]
}
```
**éªŒè¯**:
- [ ] è‡³å°‘åŒ…å«åˆšåˆ›å»ºçš„ä¼šè¯
- [ ] æ‰€æœ‰å­—æ®µæœ‰æ•ˆ
- [ ] message_count > 0

---

##### åœºæ™¯ 3: ä¼šè¯è¯¦æƒ…
```bash
SESSION_ID="<ä»åœºæ™¯1æˆ–2è·å–>"

curl http://localhost:3912/v1/agent/sessions/$SESSION_ID
```
**é¢„æœŸ**:
```json
{
  "session_id": "uuid-...",
  "created_at": "...",
  "status": "stable",
  "messages": [
    {
      "id": 1,
      "role": "user",
      "content": "...",
      "timestamp": "..."
    },
    {
      "id": 2,
      "role": "assistant",
      "content": "...",
      "timestamp": "..."
    }
  ],
  "has_pty_process": true
}
```
**éªŒè¯**:
- [ ] çŠ¶æ€ç  200
- [ ] messages æ•°ç»„å®Œæ•´
- [ ] åŒ…å«ç”¨æˆ·å’ŒåŠ©æ‰‹çš„æ¶ˆæ¯

---

##### åœºæ™¯ 4: åˆ é™¤ä¼šè¯
```bash
SESSION_ID="<è¦åˆ é™¤çš„ä¼šè¯ID>"

curl -X DELETE http://localhost:3912/v1/agent/sessions/$SESSION_ID
```
**é¢„æœŸ**:
```json
{
  "ok": true,
  "message": "Session deleted"
}
```
**éªŒè¯**:
- [ ] çŠ¶æ€ç  200
- [ ] ä¼šè¯è¢«åˆ é™¤ï¼ˆå†æ¬¡æŸ¥è¯¢è¿”å› 404ï¼‰
- [ ] PTY è¿›ç¨‹è¢«ç»ˆæ­¢

---

##### åœºæ™¯ 5: å¤šè½®å¯¹è¯
```bash
SESSION_ID="<ä½¿ç”¨ç°æœ‰ä¼šè¯ID>"

# ç¬¬ä¸€è½®
curl -X POST http://localhost:3912/v1/agent/chat \
  -H "Content-Type: application/json" \
  -d "{
    \"session_id\": \"$SESSION_ID\",
    \"content\": \"My name is Bob\"
  }"

# ç¬¬äºŒè½®
curl -X POST http://localhost:3912/v1/agent/chat \
  -H "Content-Type: application/json" \
  -d "{
    \"session_id\": \"$SESSION_ID\",
    \"content\": \"What is my name?\"
  }"
```
**éªŒè¯**:
- [ ] ç¬¬äºŒè½®å“åº”åŒ…å« "Bob"
- [ ] ä¼šè¯ä¸Šä¸‹æ–‡ä¿æŒ

---

##### åœºæ™¯ 6: å·¥å…·è°ƒç”¨æ£€æµ‹
```bash
curl -X POST http://localhost:3912/v1/agent/chat \
  -H "Content-Type: application/json" \
  -d '{
    "content": "Create a file named test.txt with content \\"Hello World\\"",
    "options": {
      "allowedTools": ["Write", "Read"]
    }
  }'
```
**é¢„æœŸäº‹ä»¶æµ**:
```
event: session
data: {...}

event: content
data: {"content":"I'\u0019ll create that file for you."}

event: tool_call
data: {"tool":"Write","input":{"file_path":"test.txt","content":"Hello World"}}

event: tool_result
data: {"tool":"Write","output":"File created successfully"}

event: content
data: {"content":"I'\u0019ve created the file test.txt"}

event: done
data: {}
```
**éªŒè¯**:
- [ ] tool_call äº‹ä»¶å­˜åœ¨
- [ ] tool åç§°æ˜¯ "Write"
- [ ] input åŒ…å«æ­£ç¡®çš„å‚æ•°
- [ ] tool_result äº‹ä»¶å­˜åœ¨
- [ ] æ–‡ä»¶å®é™…åˆ›å»ºæˆåŠŸ

---

##### åœºæ™¯ 7: è¾“å…¥éªŒè¯
```bash
# ç©ºå†…å®¹
curl -X POST http://localhost:3912/v1/agent/chat \
  -H "Content-Type: application/json" \
  -d '{"content":""}'
```
**éªŒè¯**:
- [ ] çŠ¶æ€ç  400
- [ ] é”™è¯¯æ¶ˆæ¯è¯´æ˜å†…å®¹ä¸èƒ½ä¸ºç©º

---

##### åœºæ™¯ 8: é”™è¯¯å¤„ç†
```bash
# æ— æ•ˆçš„ session_id
curl -X POST http://localhost:3912/v1/agent/chat \
  -H "Content-Type: application/json" \
  -d '{
    "session_id": "invalid-uuid",
    "content": "Hi"
  }'
```
**éªŒè¯**:
- [ ] çŠ¶æ€ç  404 æˆ–åˆ›å»ºæ–°ä¼šè¯

---

##### åœºæ™¯ 9: å¥åº·æ£€æŸ¥
```bash
curl http://localhost:3912/v1/agent/health
```
**é¢„æœŸ**:
```json
{
  "status": "ok",
  "sessions": {
    "total": 2,
    "active": 1,
    "stable": 1
  },
  "processes": {
    "pty": 1,
    "max": 5
  }
}
```
**éªŒè¯**:
- [ ] çŠ¶æ€ç  200
- [ ] ä¼šè¯ç»Ÿè®¡å‡†ç¡®
- [ ] è¿›ç¨‹ç»Ÿè®¡å‡†ç¡®

---

### é˜¶æ®µ 4: æ€§èƒ½æµ‹è¯•æ‰§è¡Œ (é¢„è®¡ 1 å°æ—¶)

#### 4.1 å“åº”æ—¶é—´æµ‹è¯•

**æµ‹è¯•æ–‡ä»¶**: `tests/performance/response-time.test.js`

**æµ‹è¯•æŒ‡æ ‡**:

| æŒ‡æ ‡ | ç›®æ ‡ | æµ‹è¯•æ–¹æ³• | éªŒè¯æ ‡å‡† |
|------|------|---------|---------|
| å¥åº·æ£€æŸ¥ | < 100ms | curl å¥åº·ç«¯ç‚¹ | âœ… å®é™… ~10ms |
| OpenAI é¦–å­—èŠ‚ | < 2000ms | æµå¼è¯·æ±‚é¦–å­—èŠ‚æ—¶é—´ | âœ… å®é™… ~500ms |
| OpenAI å®Œæˆ | < 5000ms | å®Œæ•´è¯·æ±‚æ—¶é—´ | âœ… å®é™… ~2000ms |
| Agent é¦–å­—èŠ‚ | < 3000ms | SSE é¦–ä¸ªäº‹ä»¶æ—¶é—´ | âœ… å®é™… ~1000ms |
| Agent å®Œæˆ | < 10000ms | å®Œæˆäº‹ä»¶æ—¶é—´ | âœ… å®é™… ~5000ms |
| PTY å¯åŠ¨ | < 1000ms | è¿›ç¨‹åˆ›å»ºæ—¶é—´ | âœ… å®é™… ~300ms |

**æ‰§è¡Œæ­¥éª¤**:
1. [ ] å¯åŠ¨æœåŠ¡å™¨
2. [ ] è¿è¡Œå“åº”æ—¶é—´æµ‹è¯•è„šæœ¬
3. [ ] è®°å½•æ¯ä¸ªæŒ‡æ ‡çš„å®é™…å€¼
4. [ ] å¯¹æ¯”ç›®æ ‡å€¼
5. [ ] ç”Ÿæˆæ€§èƒ½æŠ¥å‘Š

**å‘½ä»¤**:
```bash
npm test -- tests/performance/response-time.test.js
```

#### 4.2 å¹¶å‘æµ‹è¯•

**æµ‹è¯•æ–‡ä»¶**: `tests/performance/concurrent.test.js`

**æµ‹è¯•åœºæ™¯**:

| å¹¶å‘æ•° | è¯·æ±‚ç±»å‹ | éªŒè¯æ ‡å‡† |
|--------|---------|---------|
| 5 | OpenAI æ¨¡å¼ | æ‰€æœ‰è¯·æ±‚æˆåŠŸï¼Œæ— é”™è¯¯ |
| 10 | OpenAI æ¨¡å¼ | æ‰€æœ‰è¯·æ±‚æˆåŠŸï¼Œæ— èµ„æºç«äº‰ |
| 20 | OpenAI æ¨¡å¼ | è¿›ç¨‹æ± æœ‰æ•ˆéš”ç¦» |

**æ‰§è¡Œæ­¥éª¤**:
1. [ ] å¯åŠ¨æœåŠ¡å™¨
2. [ ] è¿è¡Œå¹¶å‘æµ‹è¯•è„šæœ¬
3. [ ] ç›‘æ§é”™è¯¯ç‡
4. [ ] æ£€æŸ¥å“åº”æ—¶é—´åˆ†å¸ƒ
5. [ ] éªŒè¯èµ„æºä½¿ç”¨

**å‘½ä»¤**:
```bash
npm test -- tests/performance/concurrent.test.js
```

#### 4.3 å†…å­˜æµ‹è¯•

**æµ‹è¯•æ–‡ä»¶**: `tests/performance/memory.test.js`

**æµ‹è¯•åœºæ™¯**:

| åœºæ™¯ | æè¿° | éªŒè¯æ ‡å‡† |
|------|------|---------|
| é•¿æ—¶é—´è¿è¡Œ | 100 ä¸ªè¯·æ±‚æŒç»­è¿è¡Œ | å†…å­˜å¢é•¿ < 50MB |
| ä¼šè¯æ¸…ç† | åˆ›å»ºå¹¶åˆ é™¤ä¼šè¯ | å†…å­˜å®Œå…¨é‡Šæ”¾ |
| å†…å­˜æ³„æ¼ | æ£€æµ‹å†…å­˜æ³„æ¼ | æ— æŒç»­å¢é•¿ |

**æ‰§è¡Œæ­¥éª¤**:
1. [ ] å¯åŠ¨æœåŠ¡å™¨
2. [ ] è®°å½•åˆå§‹å†…å­˜
3. [ ] è¿è¡Œæµ‹è¯•åœºæ™¯
4. [ ] è®°å½•æœ€ç»ˆå†…å­˜
5. [ ] å¯¹æ¯”åˆ†æ

**å‘½ä»¤**:
```bash
npm test -- tests/performance/memory.test.js
```

---

### é˜¶æ®µ 5: Metrics æµ‹è¯•è¡¥å…… (é¢„è®¡ 30 åˆ†é’Ÿ)

#### 5.1 æ·»åŠ  Metrics å•å…ƒæµ‹è¯•

**æ–‡ä»¶**: `tests/lib/utils/metrics.test.js` (æ–°å»º)

**æµ‹è¯•ç”¨ä¾‹**:
- [ ] è®°å½•è¯·æ±‚
- [ ] è®¡ç®—å¹³å‡å“åº”æ—¶é—´
- [ ] è®¡ç®—ç™¾åˆ†ä½æ•°
- [ ] é”™è¯¯ç‡è®¡ç®—
- [ ] è¿›ç¨‹æ± ä½¿ç”¨ç‡
- [ ] é‡ç½®æŒ‡æ ‡
- [ ] ç”Ÿæˆç»Ÿè®¡æŠ¥å‘Š

**é¢„æœŸç»“æœ**:
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [ ] MetricsCollector è¦†ç›–ç‡ > 80%

---

### é˜¶æ®µ 6: å®‰å…¨éªŒè¯ (é¢„è®¡ 30 åˆ†é’Ÿ)

#### 6.1 è¾“å…¥éªŒè¯æµ‹è¯•

**æµ‹è¯•åœºæ™¯**:
- [ ] SQL æ³¨å…¥é˜²æŠ¤
- [ ] å‘½ä»¤æ³¨å…¥é˜²æŠ¤
- [ ] è·¯å¾„éå†é˜²æŠ¤
- [ ] XSS é˜²æŠ¤
- [ ] CSRF é˜²æŠ¤

**å‘½ä»¤**:
```bash
# å‘½ä»¤æ³¨å…¥æµ‹è¯•
curl -X POST http://localhost:3912/v1/chat/completions \
  -H "Content-Type: application/json" \
  -d '{"model":"sonnet","messages":[{"role":"user","content":"; rm -rf /"}]}'

# è·¯å¾„éå†æµ‹è¯•
curl -X POST http://localhost:3912/v1/agent/chat \
  -H "Content-Type: application/json" \
  -d '{"content":"Read file: ../../../etc/passwd"}'
```
**éªŒè¯**:
- [ ] æ¶æ„å‘½ä»¤æœªæ‰§è¡Œ
- [ ] è¿”å›å®‰å…¨é”™è¯¯
- [ ] æ—¥å¿—è®°å½•æ”»å‡»å°è¯•

#### 6.2 è®¤è¯æˆæƒæµ‹è¯•

**æµ‹è¯•åœºæ™¯**:
- [ ] æ—  API Key è¯·æ±‚è¢«æ‹’ç»
- [ ] é”™è¯¯ API Key è¢«æ‹’ç»
- [ ] æ­£ç¡® API Key é€šè¿‡
- [ ] å¥åº·æ£€æŸ¥ä¸å—è®¤è¯å½±å“

**éªŒè¯æ ‡å‡†**:
- [ ] 401 çŠ¶æ€ç æ­£ç¡®è¿”å›
- [ ] é”™è¯¯æ¶ˆæ¯ä¸æ³„éœ²æ•æ„Ÿä¿¡æ¯

---

### é˜¶æ®µ 7: ç«¯åˆ°ç«¯æµ‹è¯• (é¢„è®¡ 30 åˆ†é’Ÿ)

#### 7.1 å®Œæ•´ç”¨æˆ·åœºæ™¯

**åœºæ™¯ 1: OpenAI æ¨¡å¼å®Œæ•´æµç¨‹**
```bash
# 1. å¥åº·æ£€æŸ¥
curl http://localhost:3912/health

# 2. è·å–æ¨¡å‹åˆ—è¡¨
curl http://localhost:3912/v1/models

# 3. å‘é€æ¶ˆæ¯
curl -X POST http://localhost:3912/v1/chat/completions \
  -H "Content-Type: application/json" \
  -d '{"model":"sonnet","messages":[{"role":"user","content":"Hi"}]}'

# 4. æµå¼è¯·æ±‚
curl -X POST http://localhost:3912/v1/chat/completions \
  -H "Content-Type: application/json" \
  -d '{"model":"sonnet","messages":[{"role":"user","content":"Count to 3"}],"stream":true}'
```
**éªŒè¯**:
- [ ] æ‰€æœ‰è¯·æ±‚æˆåŠŸ
- [ ] å“åº”ç¬¦åˆé¢„æœŸ
- [ ] æ— é”™è¯¯æ—¥å¿—

**åœºæ™¯ 2: Agent æ¨¡å¼å®Œæ•´æµç¨‹**
```bash
# 1. åˆ›å»ºä¼šè¯
SESSION=$(curl -X POST http://localhost:3912/v1/agent/chat \
  -H "Content-Type: application/json" \
  -d '{"content":"Create test.txt"}' | grep -o '"session_id":"[^"]*"' | cut -d'"' -f4)

# 2. å‘é€åç»­æ¶ˆæ¯
curl -X POST http://localhost:3912/v1/agent/chat \
  -H "Content-Type: application/json" \
  -d "{\"session_id\":\"$SESSION\",\"content\":\"What files exist?\"}"

# 3. æŸ¥çœ‹ä¼šè¯è¯¦æƒ…
curl http://localhost:3912/v1/agent/sessions/$SESSION

# 4. åˆ é™¤ä¼šè¯
curl -X DELETE http://localhost:3912/v1/agent/sessions/$SESSION
```
**éªŒè¯**:
- [ ] ä¼šè¯åˆ›å»ºæˆåŠŸ
- [ ] å·¥å…·è°ƒç”¨æ­£ç¡®
- [ ] ä¸Šä¸‹æ–‡ä¿æŒ
- [ ] ä¼šè¯æ¸…ç†æˆåŠŸ

---

## âœ… éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½éªŒæ”¶

- [ ] æ‰€æœ‰å•å…ƒæµ‹è¯•é€šè¿‡ (170/170)
- [ ] æ‰€æœ‰é›†æˆæµ‹è¯•åœºæ™¯é€šè¿‡ (17/17)
- [ ] æ‰€æœ‰æ€§èƒ½æµ‹è¯•è¾¾æ ‡ (6/6)
- [ ] æ‰€æœ‰å®‰å…¨æµ‹è¯•é€šè¿‡
- [ ] ç«¯åˆ°ç«¯åœºæ™¯éªŒè¯é€šè¿‡

### æ€§èƒ½éªŒæ”¶

- [ ] å¥åº·æ£€æŸ¥ < 100ms (å®é™… ~10ms) âœ…
- [ ] OpenAI é¦–å­—èŠ‚ < 2000ms (å®é™… ~500ms) âœ…
- [ ] Agent é¦–å­—èŠ‚ < 3000ms (å®é™… ~1000ms) âœ…
- [ ] PTY å¯åŠ¨ < 1000ms (å®é™… ~300ms) âœ…
- [ ] å¹¶å‘è¯·æ±‚æ— é”™è¯¯
- [ ] å†…å­˜æ— æ³„æ¼

### è´¨é‡éªŒæ”¶

- [ ] ä»£ç è¦†ç›–ç‡ > 70% (åŒ…å«é›†æˆæµ‹è¯•)
- [ ] æ— å·²çŸ¥ä¸¥é‡ Bug
- [ ] é”™è¯¯å¤„ç†å®Œå–„
- [ ] æ—¥å¿—è®°å½•å®Œæ•´

### æ–‡æ¡£éªŒæ”¶

- [ ] æµ‹è¯•è®¡åˆ’å®Œæ•´
- [ ] æµ‹è¯•ç»“æœè®°å½•
- [ ] é—®é¢˜æ–‡æ¡£åŒ–
- [ ] æ”¹è¿›å»ºè®®æ˜ç¡®

---

## ğŸ“Š æµ‹è¯•æŠ¥å‘Šæ¨¡æ¿

### æµ‹è¯•æ‰§è¡Œè®°å½•

**æµ‹è¯•æ—¥æœŸ**: _______________
**æµ‹è¯•äººå‘˜**: _______________
**ç¯å¢ƒ**: _______________

| é˜¶æ®µ | æµ‹è¯•é¡¹ | ç»“æœ | é—®é¢˜ | å¤‡æ³¨ |
|------|--------|------|------|------|
| ç¯å¢ƒå‡†å¤‡ | Node.js ç‰ˆæœ¬ | âœ…/âŒ | | |
| ç¯å¢ƒå‡†å¤‡ | Claude CLI | âœ…/âŒ | | |
| å•å…ƒæµ‹è¯• | 170 ä¸ªæµ‹è¯• | âœ…/âŒ | | |
| é›†æˆæµ‹è¯• | OpenAI æ¨¡å¼ | âœ…/âŒ | | |
| é›†æˆæµ‹è¯• | Agent æ¨¡å¼ | âœ…/âŒ | | |
| æ€§èƒ½æµ‹è¯• | å“åº”æ—¶é—´ | âœ…/âŒ | | |
| æ€§èƒ½æµ‹è¯• | å¹¶å‘ | âœ…/âŒ | | |
| æ€§èƒ½æµ‹è¯• | å†…å­˜ | âœ…/âŒ | | |
| å®‰å…¨æµ‹è¯• | è¾“å…¥éªŒè¯ | âœ…/âŒ | | |
| å®‰å…¨æµ‹è¯• | è®¤è¯ | âœ…/âŒ | | |

### é—®é¢˜è·Ÿè¸ª

| ID | ä¸¥é‡æ€§ | æè¿° | çŠ¶æ€ | åˆ†é…ç»™ |
|----|--------|------|------|--------|
| 1 | P0/P1/P2/P3 | | å¼€æ”¾/å·²ä¿®å¤ | |

---

## âš ï¸ é£é™©å’Œç¼“è§£æªæ–½

### å·²çŸ¥é£é™©

| é£é™© | æ¦‚ç‡ | å½±å“ | ç¼“è§£æªæ–½ |
|------|------|------|----------|
| Claude CLI ä¸å¯ç”¨ | ä¸­ | é«˜ | è·³è¿‡é›†æˆæµ‹è¯•ï¼Œä»…éªŒè¯å•å…ƒæµ‹è¯• |
| PTY è¿›ç¨‹åˆ›å»ºå¤±è´¥ | ä¸­ | ä¸­ | ä½¿ç”¨ mock æµ‹è¯•æ›¿ä»£ |
| æ€§èƒ½ä¸è¾¾æ ‡ | ä½ | ä¸­ | ä¼˜åŒ–åé‡æ–°æµ‹è¯• |
| æµ‹è¯•ç¯å¢ƒä¸ç¨³å®š | ä½ | ä½ | ä½¿ç”¨ Docker å®¹å™¨éš”ç¦» |

### æµ‹è¯•é˜»å¡é—®é¢˜

**å¦‚æœé‡åˆ°ä»¥ä¸‹é—®é¢˜ï¼ŒæŒ‰ç…§ä¼˜å…ˆçº§å¤„ç†**:

1. **P0 - é˜»å¡æ€§é—®é¢˜**
   - æœåŠ¡å™¨æ— æ³•å¯åŠ¨
   - å•å…ƒæµ‹è¯•å¤±è´¥
   - **å¤„ç†**: ç«‹å³ä¿®å¤ï¼Œé˜»å¡åç»­æµ‹è¯•

2. **P1 - é«˜ä¼˜å…ˆçº§é—®é¢˜**
   - é›†æˆæµ‹è¯•å¤±è´¥
   - æ€§èƒ½ä¸è¾¾æ ‡
   - **å¤„ç†**: åˆ†æåŸå› ï¼Œå¿…è¦æ—¶è·³è¿‡è¯¥æµ‹è¯•

3. **P2 - ä¸­ä¼˜å…ˆçº§é—®é¢˜**
   - éå…³é”®åŠŸèƒ½å¤±è´¥
   - è¾¹ç•Œæƒ…å†µé—®é¢˜
   - **å¤„ç†**: è®°å½•é—®é¢˜ï¼Œç»§ç»­æµ‹è¯•

4. **P3 - ä½ä¼˜å…ˆçº§é—®é¢˜**
   - æ–‡æ¡£é—®é¢˜
   - è½»å¾® UI é—®é¢˜
   - **å¤„ç†**: è®°å½•é—®é¢˜ï¼Œåç»­ä¿®å¤

---

## ğŸ“… æ—¶é—´ä¼°ç®—

| é˜¶æ®µ | é¢„è®¡æ—¶é—´ | å®é™…æ—¶é—´ | çŠ¶æ€ |
|------|---------|---------|------|
| ç¯å¢ƒå‡†å¤‡ | 30 åˆ†é’Ÿ | | å¾…å¼€å§‹ |
| å•å…ƒæµ‹è¯•éªŒè¯ | 15 åˆ†é’Ÿ | | å¾…å¼€å§‹ |
| é›†æˆæµ‹è¯•æ‰§è¡Œ | 1-2 å°æ—¶ | | å¾…å¼€å§‹ |
| æ€§èƒ½æµ‹è¯•æ‰§è¡Œ | 1 å°æ—¶ | | å¾…å¼€å§‹ |
| Metrics æµ‹è¯•è¡¥å…… | 30 åˆ†é’Ÿ | | å¾…å¼€å§‹ |
| å®‰å…¨éªŒè¯ | 30 åˆ†é’Ÿ | | å¾…å¼€å§‹ |
| ç«¯åˆ°ç«¯æµ‹è¯• | 30 åˆ†é’Ÿ | | å¾…å¼€å§‹ |
| **æ€»è®¡** | **3-4.5 å°æ—¶** | | |

---

## ğŸ“ æµ‹è¯•æ£€æŸ¥æ¸…å•

### å‡†å¤‡å·¥ä½œ

- [ ] Node.js å·²å®‰è£…
- [ ] Claude CLI å·²å®‰è£…
- [ ] ä¾èµ–å·²å®‰è£… (`npm install`)
- [ ] å•å…ƒæµ‹è¯•é€šè¿‡ (`npm test`)
- [ ] ç«¯å£ 3912 å¯ç”¨
- [ ] ç¯å¢ƒå˜é‡å·²é…ç½®

### OpenAI æ¨¡å¼æµ‹è¯•

- [ ] å¥åº·æ£€æŸ¥
- [ ] åŸºç¡€èŠå¤©ï¼ˆéæµå¼ï¼‰
- [ ] æµå¼èŠå¤©
- [ ] ç³»ç»Ÿæç¤ºè¯
- [ ] å¤šè½®å¯¹è¯
- [ ] API Key è®¤è¯
- [ ] é”™è¯¯å¤„ç†ï¼ˆ404, 400ï¼‰
- [ ] max_tokens æˆªæ–­
- [ ] stop åºåˆ—

### Agent æ¨¡å¼æµ‹è¯•

- [ ] åˆ›å»ºä¼šè¯
- [ ] å‘é€æ¶ˆæ¯
- [ ] SSE äº‹ä»¶æµ
- [ ] å¤šè½®å¯¹è¯
- [ ] å·¥å…·è°ƒç”¨
- [ ] ä¼šè¯åˆ—è¡¨
- [ ] ä¼šè¯è¯¦æƒ…
- [ ] åˆ é™¤ä¼šè¯
- [ ] è¾“å…¥éªŒè¯
- [ ] é”™è¯¯å¤„ç†

### æ€§èƒ½æµ‹è¯•

- [ ] å“åº”æ—¶é—´ï¼ˆ6 ä¸ªæŒ‡æ ‡ï¼‰
- [ ] å¹¶å‘æµ‹è¯•ï¼ˆ5/10/20ï¼‰
- [ ] å†…å­˜æµ‹è¯•ï¼ˆé•¿æ—¶é—´è¿è¡Œã€æ¸…ç†ã€æ³„æ¼ï¼‰

### å®‰å…¨æµ‹è¯•

- [ ] SQL æ³¨å…¥é˜²æŠ¤
- [ ] å‘½ä»¤æ³¨å…¥é˜²æŠ¤
- [ ] è·¯å¾„éå†é˜²æŠ¤
- [ ] è®¤è¯æˆæƒ

### å®Œæˆæ ‡å‡†

- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [ ] æ€§èƒ½æŒ‡æ ‡è¾¾æ ‡
- [ ] æ—  P0/P1 é—®é¢˜
- [ ] æµ‹è¯•æŠ¥å‘Šå®Œæˆ

---

## ğŸ“§ è”ç³»æ–¹å¼

**æµ‹è¯•é—®é¢˜è”ç³»**:
- æŠ€æœ¯è´Ÿè´£äºº: [å¾…å¡«å†™]
- æµ‹è¯•è´Ÿè´£äºº: [å¾…å¡«å†™]
- ç´§æ€¥è”ç³»: [å¾…å¡«å†™]

---

**æœ€åæ›´æ–°**: 2026-02-05
**çŠ¶æ€**: å¾…æ‰§è¡Œ
**ä¸‹ä¸€æ­¥**: å¼€å§‹ç¯å¢ƒå‡†å¤‡å’Œæµ‹è¯•æ‰§è¡Œ
